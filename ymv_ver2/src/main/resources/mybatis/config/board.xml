<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="board"> 
 
<resultMap type="recruitbvo" id="boardRM">      
      <result property="recruitNo" column="recruit_no"/>         
      <result property="startDate" column="start_date" />       
      <result property="endDate" column="end_date" />       
   </resultMap>
   
   <select id="getFieldList" resultType="fieldvo">
       select * from field
    </select>
    
    <select id="getLocationList" resultType="locationvo">
       select * from location order by location asc
    </select>
   
   <select id="getBoardList" resultMap="boardRM" resultType="recruitbvo">   
   select recruit_no, title, field, location, age, start_date, end_date 
   from(select recruit_no, title, field, location, age, start_date, end_date, CEIL(rownum/5) AS page from(select recruit_no, title, field, location, age, start_date, end_date from recruit order by recruit_no desc) ) 
   where page=#{value} 
   </select>

   <select id="getRecruitBoardByRecruitNo" resultMap="boardRM" resultType="recruitbvo">   
   select recruit_no, title, field, location, age, start_date, end_date,content from recruit where recruit_no=#{value}
   </select>

   <select id="showContent"  resultMap="boardRM" resultType="recruitbvo">
      select recruit_no ,title, field, location, age, start_date , end_date ,content
   from recruit
   where recruit_no=#{value}
   </select>
	
    <insert id="registerVolunteer" parameterType="recruitbvo">
       <selectKey keyProperty="recruitNo" resultType="int" order="BEFORE">
          select recruit_no_seq.nextval from dual
       </selectKey>
       insert into recruit(recruit_no,title,field,location,age,start_date,end_date,content,member_no,time_posted,hit) values(#{recruitNo},#{title},#{field},#{location},#{age},to_date(#{startDate},'HH24:MI'),to_date(#{endDate},'HH24:MI'),#{content},1, sysdate ,0)
       <!-- member_no값에 현재 1이 들어가 있음 나중에 할 때 session에서 받아와서 집어넣기 -->
    </insert>

	<select id="totalContent" resultType="int">
		select count(*) from recruit
	</select>	
	
	<delete id="deleteRecruitVolunteer" parameterType="recruitbvo">
   delete recruit where recruit_no=#{value}
   </delete>
	
	<select id="findRecruitBoardByrecruitNo" resultMap="boardRM">
 		select * from recruit where recruit_no=#{value}
 	</select>
	
   <update id="updateBoard" parameterType="recruitbvo">
   update recruit set title=#{title},content=#{content},start_date=to_date(#{startDate},'HH24:MI'),end_date=to_date(#{endDate},'HH24:MI'),field=#{field} ,location=#{location} ,age=#{age} 
   where recruit_no=#{recruitNo}
   </update>
	
 </mapper> 