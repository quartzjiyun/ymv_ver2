<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="scheduler">
	<resultMap type="recruitbvo" id="boardRM">
		<result property="recruitNo" column="recruit_no" />
		<result property="startDate" column="start_date" />
		<result property="endDate" column="end_date" />
		<result property="checkDate" column="check_date"/>
	</resultMap>
	<select id="getSchedulerList" resultMap="boardRM" parameterType="sdvo">
		select recruit_no, title, field, location, age, start_date, end_date,to_char(start_date,'YYYY-MM-DD') as check_date
		from(select recruit_no, title, field, location, age, start_date,
		end_date,
		ceil(rownum/5) as page from(select recruit_no, title, field,
		location, age,
		start_date, end_date from recruit
		<where>
			<if test="field != ''">
				AND field=#{field}
			</if>
			<if test="location != null">
				AND location=#{location}
			</if>
			<if test="startDate != ''">
  <![CDATA[
    AND to_char(start_date,'HH24:MI')>=#{startDate} 
     ]]>
			</if>
			<if test="endDate != ''">
  <![CDATA[
    AND to_char(end_date,'HH24:MI')<=#{endDate}
     ]]>
			</if>
		</where>
		order by recruit_no desc) )
	</select>
	<select id="getSearchList" resultMap="boardRM" parameterType="scvo">
		select recruit_no, title, field, location, age, start_date, end_date
		from(select recruit_no, title, field, location, age, start_date,
		end_date,
		ceil(rownum/5) as page from(select recruit_no, title, field,
		location, age,
		start_date, end_date from recruit
		<where>
			<if test="field != ''">
				AND field=#{field}
			</if>
			<if test="location != ''">
				AND location=#{location}
			</if>
			<if test="startDate != ''">
  <![CDATA[
    AND start_date>=#{startDate} AND end_date<=#{endDate}
     ]]>
			</if>
		</where>
		order by recruit_no desc) )
		where page=#{pageNo}
	</select>
	<select id="totalContent" parameterType="scvo" resultType="int">
		select count(*) from recruit
		<where>
			<if test="field != ''">
				AND field=#{field}
			</if>
			<if test="location != ''">
				AND location=#{location}
			</if>
		</where>
	</select>
	<select id="getDateList" parameterType="sdvo" resultType="hashMap">
		select distinct(to_char(start_date,'YYYY-MM-DD')) as date_list from recruit
		<where>
			<if test="field != ''">
				AND field=#{field}
			</if>
			<if test="location != null">
				AND location=#{location}
			</if>
			<if test="startDate != ''">
  <![CDATA[
    AND to_char(start_date,'HH24:MI')>=#{startDate} 
     ]]>
			</if>
			<if test="endDate != ''">
  <![CDATA[
    AND to_char(end_date,'HH24:MI')<=#{endDate}
     ]]>
			</if>
		</where>
		order by date_list asc
	</select>
</mapper> 