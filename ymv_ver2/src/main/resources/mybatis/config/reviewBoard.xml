<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="reviewBoard">
 	<resultMap type="rbvo" id="boardRM">      
      <result property="boardNo" column="board_no"/>         
      <result property="memberNo" column="member_no"/>
      <result property="timePosted" column="time_posted"/>
   </resultMap>
 
    <select id="findByReviewNo" parameterType="int" resultType="rbvo">
       select * from board where board_no=#{value}
    </select>
    <select id="getBoardList" resultType="rbvo">
    	select boardNo, title, writer, content, memberNo, timePosted, hit from(select board_no as boardNo, title, writer, content, member_no as memberNo, time_posted as timePosted, hit, CEIL(rownum/5) AS page from board where board_type='review') where page=#{value}
    </select>
    <select id="totalContent" resultType="int">
    	select count(*) from board where board_type='review'
    </select>
    <select id="getReviewBoardByBoardNo" resultMap="boardRM" resultType="rbvo">   
		select board_no, title, writer, content, member_no, time_posted from board where board_no=#{value}
	</select>
	<insert id="registerReviewComment" parameterType="cmvo">
		insert into YMV_COMMENT(comment_no, writer, content, time_posted, board_no) values(ymv_seq.nextval,#{writer},#{content},sysdate,#{boardNo})
	</insert>
	<resultMap type="cmvo" id="commentRM">
		<result property="commentNo" column="comment_no"/>
		<result property="timePosted" column="time_posted"/>
		<result property="boardNo" column="board_no"/>
	</resultMap>
	<select id="findByCommentNo" resultMap="commentRM">
		select * from ymv_comment where board_no=#{boardNo} order by comment_no desc
	</select>
	<delete id="deleteReviewComment" parameterType="cmvo">
		delete from ymv_comment where board_no=#{boardNo} and comment_no=#{commentNo}
	</delete>
 </mapper>
 
 
 
 
 
 